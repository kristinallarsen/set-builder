<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IIIF Image Gallery Builder</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.0.0/openseadragon.min.js"></script>
  <style> 
  /* Viewer hint overlay */ 
    #viewer { position: relative; } 
    #viewerHint { position: absolute; 
      left: 50%; 
      top: 50%; 
      transform: translate(-50%, -50%); 
      color: #7e7d7d; 
      font-size: 1rem; 
      text-align: center; 
      pointer-events: none; 
      padding: 0.5rem 0.75rem; 
      background: rgba(255, 255, 255, 0.85); 
      border-radius: 6px; } 

  /* Hide the hint once an image has been opened */ 
  .viewer-has-image #viewerHint { display: none !important; } 
 
  </style>

</head>
<body>
  <div class="container">
    <div class="left-panel">
      <div class="header">
        <div class="header-top">
  <img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/International_Image_Interoperability_Framework_logo.png" alt="IIIF Logo" class="iiif-logo">
  <h1 id="page-title">
    <span class="title-base">IIIF Image Gallery Builder</span>
    <span class="title-gallery" id="gallery-title-display"></span>
  </h1>

  <div class="control-links">
  <a href="info.html" class="control-link" target="_blank">â“˜ Get Help</a>
  <a href="#" id="toggleInputs" class="control-link">Hide Inputs</a>
  <a href="#" id="toggleViewer" class="control-link">Hide Viewer</a>
</div>
</div>

    <div class="section-divider"></div>
          
        <div id="inputPanel" class="input-panel">
  <!-- Add Manifests Section -->
  <div class="input-section">
    <label for="manifestUrl" class="section-label">Add IIIF Manifests</label>
    <input type="text" id="manifestUrl" placeholder="Enter IIIF Manifest URLs (comma-separated)" />
    <button id="addManifest">Add Manifest(s)</button>
  </div>

  <div class="section-divider"></div>

  <!-- Load Gallery Section -->
  <div class="input-section">
    <label class="section-label">Load Gallery</label>
    
    <div class="load-option">
  <label for="uploadManifest" class="file-input-label">Choose File</label>
  <input type="file" id="uploadManifest" accept=".json" style="display: none;" />
  <span id="fileName" class="file-name">No file chosen</span>
</div>

    <div class="load-option-divider">OR</div>

    <div class="load-option">
      <input type="text" id="galleryUrl" placeholder="Paste gallery JSON URL" />
    </div>
    <button id="loadFromUrl">Load from URL</button>
  </div>

  <div class="section-divider"></div>

  <!-- Save Gallery Section -->
<div class="input-section">
  <label for="manifestName" class="section-label">Save Gallery</label>
  <input type="text" id="manifestName" placeholder="Enter gallery name">

  <div class="export-buttons-row">
<button id="saveLocally">ðŸ’¾  Save File</button>

    <button id="exportForViewers" class="export-iiif-btn" title="Export for IIIF Viewers">
      <img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/International_Image_Interoperability_Framework_logo.png" 
           alt="Export Manifest" 
           class="iiif-export-icon">
    </button>
  </div>
  </div> <!-- Close input-section -->
</div> <!-- Close inputPanel -->
</div> <!-- Close header -->

<div id="gallery"></div>
   </div> <!-- Close left-panel -->
  
    <!-- Resizable divider -->
    <div id="resizer"></div>
    
    <div id="viewer">
      <div id="viewerHint">Click any thumbnail to load an image.</div>
    </div>
  </div> <!-- Close container -->
    

    <script src="script.js"></script>
    
    <!-- Page Selector Modal -->
    <div id="pageSelectorModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Select Pages to Add</h2>
          <span class="close-modal">&times;</span>
        </div>
        <div class="modal-controls">
          <button id="selectAllPages" class="modal-btn">Select All</button>
          <button id="deselectAllPages" class="modal-btn">Deselect All</button>
          <span id="selectionCount">0 pages selected</span>
        </div>
        <div id="pageGrid" class="page-grid">
          <!-- Pages will be dynamically added here -->
        </div>
        <div class="modal-footer">
          <button id="cancelPageSelection" class="modal-btn-secondary">Cancel</button>
          <button id="addSelectedPages" class="modal-btn-primary">Add Selected Pages</button>
        </div>
      </div>
    </div>
  </div>

<script> document.addEventListener('DOMContentLoaded', function() { var viewerEl = document.getElementById('viewer'); if (viewerEl && !document.getElementById('viewerHint')) { var hint = document.createElement('div'); hint.id = 'viewerHint'; hint.textContent = 'Click any thumbnail to load an image.'; viewerEl.appendChild(hint); } var params = new URLSearchParams(window.location.search); var openFirst = (params.get('openFirst') === '1' || params.get('openfirst') === '1'); var opened = false; function markViewerHasImage() { document.body.classList.add('viewer-has-image'); } function tryOpenFirst() { if (opened) return; var firstThumb = document.querySelector('#gallery .card img'); if (firstThumb) { opened = true; firstThumb.click(); markViewerHasImage(); } } if (openFirst) { tryOpenFirst(); var gallery = document.getElementById('gallery'); if (gallery) { var mo = new MutationObserver(function() { tryOpenFirst(); }); mo.observe(gallery, { childList: true, subtree: true }); } } document.addEventListener('click', function(e) { if (e.target && e.target.matches('#gallery .card img')) { markViewerHasImage(); } }); }); </script>
</body>
</html>
